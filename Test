import groovy.io.FileType

// Specify the directory to scan
def rootDir = new File("/path/to/your/directory")

if (!rootDir.exists() || !rootDir.isDirectory()) {
    println "Directory does not exist or is not a directory: ${rootDir}"
    System.exit(1)
}

// Loop through all files in the directory and subdirectories
rootDir.eachFileRecurse(FileType.FILES) { file ->
    if (file.name.endsWith(".json")) {
        try {
            // Read the file content
            def content = file.text
            
            // Get the file name without extension
            def envKey = file.name.replaceAll(/\.json$/, "")
            
            // Set the environment variable
            System.setProperty(envKey, content)
            println "Environment variable set: ${envKey}"
        } catch (Exception e) {
            println "Failed to process file: ${file.absolutePath}"
            e.printStackTrace()
        }
    }
}

// Debug: Print all environment variables set
System.properties.each { key, value ->
    println "${key} = ${value}"
}
